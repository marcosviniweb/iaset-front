import{a as K}from"./chunk-OT4H7QKE.js";import{a as G}from"./chunk-INWTCM4O.js";import{a as $}from"./chunk-Q2D4LDD6.js";import{b as q,c as H,d as Y,e as J,f as B}from"./chunk-YFFUOVOG.js";import{b as F,c as x,e as V,f as T,g as N,h as U,j,k as A,l as I,m as R,o as z}from"./chunk-6L2DAN5D.js";import"./chunk-4S5XMSU5.js";import"./chunk-DX4FTDQR.js";import{j as L}from"./chunk-X4VVONUQ.js";import{h as D,n as k}from"./chunk-6KEO6D2E.js";import{Db as O,Hb as u,Ib as C,Pb as _,Qb as l,Ra as E,Sb as w,Ta as m,V as y,Zb as v,cb as S,da as M,i as b,ib as g,ja as d,ka as p,qb as P,ub as f,xb as n,yb as t,zb as s}from"./chunk-X3WKPGPN.js";function Q(r,i){r&1&&(n(0,"span",25),l(1," Campo Obrigat\xF3rio"),t())}function X(r,i){r&1&&(n(0,"span",25),l(1," Digite seu nome !"),t())}function Z(r,i){r&1&&(n(0,"span",25),l(1," Campo Obrigat\xF3rio"),t())}function ee(r,i){r&1&&(n(0,"span",25),l(1," Formato de E-mail invalido ! "),t())}function te(r,i){if(r&1&&(n(0,"span",37),l(1),t()),r&2){let e=C();P("ngClass",e.updateMessage.status),m(),w(" ",e.updateMessage.message," ")}}function ne(r,i){if(r&1){let e=O();n(0,"div")(1,"div",10),s(2,"img",40),t(),n(3,"h2",41),l(4," Cadastro efetuado com sucesso ! "),t()(),n(5,"mat-dialog-content"),l(6," Aguarde a aprova\xE7\xE3o do seu cadastro "),t(),n(7,"mat-dialog-actions")(8,"button",42),u("click",function(){d(e);let o=C();return p(o.closeDialog())}),l(9,"OK"),t()()}}function ie(r,i){if(r&1){let e=O();n(0,"div")(1,"div",10),s(2,"img",40),t(),n(3,"h2",41),l(4," Deseja mudar suas informa\xE7\xF5es ? "),t()(),n(5,"mat-dialog-actions")(6,"button",42),u("click",function(){d(e);let o=C();return p(o.editUserProfile())}),l(7,"Sim"),t(),n(8,"button",43),u("click",function(){d(e);let o=C();return p(o.closeDialog())}),l(9,"Cancelar"),t()()}}function oe(r,i){r&1&&s(0,"i",49)}function ae(r,i){r&1&&s(0,"i",50)}function re(r,i){r&1&&s(0,"i",49)}function le(r,i){r&1&&s(0,"i",50)}function se(r,i){r&1&&s(0,"i",49)}function ce(r,i){r&1&&s(0,"i",50)}function me(r,i){r&1&&(n(0,"span",25),l(1," *As senhas devem ser iguais *"),t())}function de(r,i){if(r&1&&(n(0,"span",37),l(1),t()),r&2){let e=C(2);P("ngClass",e.updateMessagePass.status),m(),w(" ",e.updateMessagePass.message," ")}}function pe(r,i){if(r&1){let e=O();n(0,"div",44)(1,"div",10),s(2,"img",40),t(),n(3,"form",45)(4,"div",21)(5,"div",46)(6,"div",23),l(7,"* Senha Atual:"),t(),s(8,"input",47,6),n(10,"button",48),u("click",function(){d(e);let o=_(9);return p(o.type==="password"?o.type="text":o.type="password")}),g(11,oe,1,0,"i",49)(12,ae,1,0,"i",50),t()()(),n(13,"div",21)(14,"div",46)(15,"div",23),l(16,"* Nova senha:"),t(),s(17,"input",51,7),n(19,"button",48),u("click",function(){d(e);let o=_(18);return p(o.type==="password"?o.type="text":o.type="password")}),g(20,re,1,0,"i",49)(21,le,1,0,"i",50),t()()(),n(22,"div",21)(23,"div",46)(24,"div",23),l(25,"* Confirme:"),t(),s(26,"input",52,8),n(28,"button",48),u("click",function(){d(e);let o=_(27);return p(o.type==="password"?o.type="text":o.type="password")}),g(29,se,1,0,"i",49)(30,ce,1,0,"i",50),t()(),g(31,me,2,0,"span",25),t()(),g(32,de,2,2,"span",37),n(33,"div",53)(34,"button",54),u("click",function(){d(e);let o=C();return p(o.editUserPassword())}),l(35,"Alterar"),t(),n(36,"button",43),u("click",function(){d(e);let o=C();return p(o.closeDialog())}),l(37,"Voltar"),t()()()}if(r&2){let e=_(9),a=_(18),o=_(27),c=C();m(3),P("formGroup",c.passwordForm),m(8),f(e.type==="password"?11:12),m(9),f(a.type==="password"?20:21),m(9),f(o.type==="password"?29:30),m(2),f(c.passwordForm.hasError("mismatch")?31:-1),m(),f(c.updateMessagePass?32:-1),m(2),P("disabled",c.passwordForm.invalid)}}var W=class r{fb=M(R);dataService=M(L);dialog=M(q);authService=M(G);updateForm=this.fb.group({name:["",[x.minLength(2)]],birthDay:[""],matricula:["",[]],cpf:["",[]],rg:["",[]],vinculo:["",[]],lotacao:["",[]],endereco:["",[]],email:["",[x.email]],phone:["",[]],photo:new N(null)});passwordForm=this.fb.group({oldPassword:["",[x.required]],newPassword:["",[x.required]],confirmPassword:["",[x.required]]});updatePassword=this.fb;imgUrl=$;userData=JSON.parse(localStorage.getItem("userData"));profileImg;destroy$=new b;updateMessage={status:"",message:""};updateMessagePass={status:"",message:""};ngOnInit(){this.passwordForm.setValidators(this.passwordMatchValidator),this.getUserData(),this.updateForm.controls.birthDay.valueChanges.subscribe(i=>{let e=this.formatarData(i);this.updateForm.controls.birthDay.setValue(e,{emitEvent:!1})})}getUserData(){this.userData&&this.updateForm.patchValue(this.userData),this.dataService.getUserData(this.userData.id).pipe(y(this.destroy$)).subscribe({next:i=>{this.updateData(i)},error:i=>{console.log(i)}})}updateData(i){localStorage.setItem("userData",JSON.stringify(i)),this.userData=i,this.updateForm.patchValue(i)}imgFile(i){let e=i.target;if(e.files&&e.files.length>0){let a=e.files[0];this.updateForm.get("photo")?.setValue(a);let o=new FileReader;o.onload=c=>{this.profileImg=c.target?.result},o.readAsDataURL(a)}}openDialog(i,e){this.dialog.open(i,{width:"100%",maxWidth:"500px",height:e||"300px",panelClass:"padding-modal"})}closeDialog(){this.dialog.closeAll()}formatarData(i){if(!i)return"";let e=new Date(i),a=e.getUTCFullYear(),o=String(e.getUTCMonth()+1).padStart(2,"0"),c=String(e.getUTCDate()).padStart(2,"0");return`${a}-${o}-${c}`}editUserProfile(){let i=new FormData;Object.keys(this.updateForm.controls).forEach(e=>{e!=="confirmPassowrd"&&i.append(e,this.updateForm.get(e)?.value)}),this.dataService.updateUserData(this.userData.id,i).subscribe({next:e=>{this.dialog.closeAll(),this.updateData(e),this.updateMessage={status:"sucess",message:"Informa\xE7\xF5es atualizadas com sucesso !"}},error:e=>{let a=e.error.message=="Internal server error"?null:e.error.message;throw this.dialog.closeAll(),this.updateMessage={status:"error",message:a?a+"cod:"+e.status:"Ocorreu um erro durante a atualiza\xE7\xE3o, tente novamente. cod:"+e.status},e}})}editUserPassword(){let i={oldPassword:this.passwordForm.value.oldPassword,newPassword:this.passwordForm.value.newPassword};this.authService.passwordChange(i).then(e=>{let a=e.message;this.updateMessagePass={status:"sucess",message:a}}).catch(e=>{throw e.error.message?this.updateMessagePass={status:"error",message:e.error.message}:this.updateMessagePass={status:"error",message:"Ocorreu um erro, tente novamente. Cod:"+e.status},console.log(e.error.message),e})}passwordMatchValidator(i){let e=i.get("newPassword")?.value,a=i.get("confirmPassword")?.value;return e===a?null:{mismatch:!0}}ngOnDestroy(){this.destroy$.next(""),this.destroy$.complete()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["app-perfil"]],decls:92,vars:5,consts:[["photo",""],["email",""],["templete",""],["templeteMsg",""],["templeteConfirm",""],["templatePass",""],["current",""],["pass",""],["confirm",""],[1,"ui","horizontal","divider"],[1,"header"],[1,"id","card","outline","icon"],[1,"ui","inverted","divider"],[1,"ui","form",3,"formGroup"],[1,"container-photo"],[1,"photo"],["type","file",3,"change"],["alt","",3,"src"],[1,"select-picture",3,"click"],[1,"camera","icon"],[1,"two","fields"],[1,"field"],[1,"ui","labeled","input"],[1,"ui","label"],["type","text","formControlName","name","placeholder","Nome"],[1,"error-msg"],["type","email","formControlName","email","placeholder","Email"],[1,"three","fields"],["type","text","formControlName","cpf","placeholder","CPF","CpfCnpjMask","","maxlength","14"],["type","text","formControlName","rg","placeholder","RG","maxlength","10"],[1,"eight","wide","field"],["type","date","placeholder","DD/MM/YYYY","formControlName","birthDay"],["type","text","formControlName","vinculo","placeholder","V\xEDnculo"],["type","text","formControlName","lotacao","placeholder","Lota\xE7\xE3o"],["type","text","formControlName","matricula","placeholder","Matr\xEDcula"],["type","text","formControlName","endereco","placeholder","Endere\xE7o"],["type","text","formControlName","phone","placeholder","(DDD) 00000-0000","PhoneMask",""],[1,"update-message",3,"ngClass"],[1,"container-button"],["type","submit",1,"ui","button",3,"click"],["src","img/white-logo.png","alt",""],[1,"dialog-title"],["type","button",1,"ui","button","primary",3,"click"],["type","button",1,"ui","button",3,"click"],[1,"content"],[1,"ui","form","dialog-form",3,"formGroup"],[1,"ui","labeled","action","input"],["type","password","formControlName","oldPassword","placeholder","A sua senha atual"],[1,"ui","icon","button",3,"click"],[1,"eye","icon"],[1,"eye","slash","icon"],["type","password","formControlName","newPassword","placeholder","Senha"],["type","password","formControlName","confirmPassword","placeholder","Digite novamente"],[1,"actions"],["type","button",1,"ui","button","primary",3,"click","disabled"]],template:function(e,a){if(e&1){let o=O();n(0,"section")(1,"div",9)(2,"div",10),s(3,"i",11),n(4,"h2"),l(5,"Seu Perfil"),t()()(),s(6,"div",12),n(7,"form",13)(8,"div",14)(9,"label"),l(10,"Foto de Perfil"),t(),n(11,"div",15)(12,"input",16,0),u("change",function(h){return d(o),p(a.imgFile(h))}),t(),s(14,"img",17),n(15,"div",18),u("click",function(){d(o);let h=_(13);return p(h.click())}),s(16,"i",19),n(17,"p"),l(18,"Selecione uma Foto"),t()()()(),n(19,"div",20)(20,"div",21)(21,"div",22)(22,"div",23),l(23,"Nome:"),t(),s(24,"input",24),t(),g(25,Q,2,0,"span",25)(26,X,2,0,"span",25),t(),n(27,"div",21)(28,"div",22)(29,"div",23),l(30,"Email:"),t(),s(31,"input",26,1),t(),g(33,Z,2,0,"span",25)(34,ee,2,0,"span",25),t()(),s(35,"div",12),n(36,"div",27)(37,"div",21)(38,"div",22)(39,"div",23),l(40,"CPF:"),t(),s(41,"input",28),t()(),n(42,"div",21)(43,"div",22)(44,"div",23),l(45,"RG:"),t(),s(46,"input",29),t()(),n(47,"div",30)(48,"div",22)(49,"div",23),l(50,"Data de Nascimento:"),t(),s(51,"input",31),t()()(),n(52,"div",27)(53,"div",21)(54,"div",22)(55,"div",23),l(56,"V\xEDnculo:"),t(),s(57,"input",32),t()(),n(58,"div",21)(59,"div",22)(60,"div",23),l(61,"Lota\xE7\xE3o:"),t(),s(62,"input",33),t()(),n(63,"div",21)(64,"div",22)(65,"div",23),l(66,"Matr\xEDcula:"),t(),s(67,"input",34),t()()(),n(68,"div",20)(69,"div",21)(70,"div",22)(71,"div",23),l(72,"Endere\xE7o:"),t(),s(73,"input",35),t()(),n(74,"div",21)(75,"div",22)(76,"div",23),l(77,"Telefone:"),t(),s(78,"input",36),t()()(),g(79,te,2,2,"span",37),n(80,"div",38,2)(82,"button",39),u("click",function(){d(o);let h=_(89);return p(a.openDialog(h))}),l(83,"Editar"),t(),n(84,"button",39),u("click",function(){d(o);let h=_(91);return p(a.openDialog(h,"400px"))}),l(85,"Alterar Senha"),t()()()(),g(86,ne,10,0,"ng-template",null,3,v)(88,ie,10,0,"ng-template",null,4,v)(90,pe,38,7,"ng-template",null,5,v)}if(e&2){let o,c;m(7),P("formGroup",a.updateForm),m(7),P("src",a.profileImg?a.profileImg:a.imgUrl+a.updateForm.value.photo,E),m(11),f((o=a.updateForm.get("name"))!=null&&o.hasError("required")&&((o=a.updateForm.get("name"))!=null&&o.touched)?25:(o=a.updateForm.get("name"))!=null&&o.hasError("minlength")&&((o=a.updateForm.get("name"))!=null&&o.dirty)?26:-1),m(8),f((c=a.updateForm.get("email"))!=null&&c.hasError("required")&&((c=a.updateForm.get("email"))!=null&&c.touched)?33:(c=a.updateForm.get("email"))!=null&&c.hasError("email")&&((c=a.updateForm.get("email"))!=null&&c.dirty)?34:-1),m(46),f(a.updateMessage?79:-1)}},dependencies:[z,U,F,V,T,I,j,A,J,Y,H,k,D,K,B],styles:["[_nghost-%COMP%]{width:100%;height:100%}.header[_ngcontent-%COMP%]{padding:20px;width:100%;display:flex;justify-content:center;background:linear-gradient(to right,#008cb7d7,#0046b7d7)}.header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px}.dialog-title[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:16px}mat-dialog-content[_ngcontent-%COMP%]{text-align:center}mat-dialog-actions[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center;margin-bottom:10px}.dialog-form[_ngcontent-%COMP%]{padding:10px!important}.dialog-form[_ngcontent-%COMP%]   .ui[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#fff!important;background:#0045b7!important}section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:355px;height:100%;background:linear-gradient(to bottom,#008cb7d7,#97bad6d7);border-radius:10px;box-shadow:1px 2px 3px #2c2c2c73;overflow:hidden}section[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-top:10px;padding:10px;width:max-content;height:min-content;display:flex;justify-content:center;align-items:center;background:#e6e6e6a6;box-shadow:0 0 2px gray;border-radius:10px}section[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:center;font-size:50px;color:#0045b7}section[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:before{height:100%;display:flex;align-items:center}section[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]{padding:10px;width:100%;height:100%;max-width:800px}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-photo[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:15px;justify-content:center}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-photo[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#fff;width:160px;background:#0045b7;padding:5px;text-align:center;border-radius:10px 10px 0 0;font-weight:600}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-photo[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:relative}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-photo[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-photo[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px;width:160px;object-fit:cover;object-position:center;box-shadow:1px 2px 3px #47474760}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-photo[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]   .select-picture[_ngcontent-%COMP%]{display:none;height:100%;width:100%;background:#6363635e;flex-direction:column;align-items:center;justify-content:center;position:absolute;color:#fff;cursor:pointer}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-photo[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]   .select-picture[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:30px}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-photo[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]   .select-picture[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500;font-size:14px}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-photo[_ngcontent-%COMP%]   .photo[_ngcontent-%COMP%]:hover   .select-picture[_ngcontent-%COMP%]{display:flex}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .fields[_ngcontent-%COMP%]{width:100%}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .fields[_ngcontent-%COMP%]   .ui[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{background:#0046b7d7;color:#fff;min-width:25%}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-button[_ngcontent-%COMP%]{margin-top:50px;display:flex;width:100%;justify-content:center}section[_ngcontent-%COMP%]   .ui.form[_ngcontent-%COMP%]   .container-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#0045b7;color:#fff;margin-right:20px;width:200px}.update-message[_ngcontent-%COMP%]{display:block;width:100%;text-align:center;font-weight:500;font-style:italic}.sucess[_ngcontent-%COMP%]{color:green}.error[_ngcontent-%COMP%]{color:red}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%;max-width:500px;max-height:420px;border-radius:10px;box-shadow:1px 2px 3px #1a1a1ab2;background:linear-gradient(to bottom,#0e5cd1d7,#05b8c5d7)}.content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding:20px;display:flex;justify-content:center;background:linear-gradient(to right,#008cb7d7,#0046b7d7);border-radius:10px 10px 0 0}.content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px}.content[_ngcontent-%COMP%]   .alert[_ngcontent-%COMP%]{padding:10px}.content[_ngcontent-%COMP%]   .alert[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center}.content[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{padding:10px}.content[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .ui[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{background:#0045b7;color:#fff}.content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}.content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:5px}  .padding-modal{padding:10px!important}.error-msg[_ngcontent-%COMP%]{display:flex;width:100%;color:red;margin-top:5px;margin-left:10px;font-size:12px}"]})};export{W as PerfilComponent};
